name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  lint:
    name: Syntax & Import Check
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: pip install -e ".[dev]"

      - name: Check Python syntax (all src files)
        run: |
          python -m py_compile src/alerts.py
          python -m py_compile src/bot.py
          python -m py_compile src/cli.py
          python -m py_compile src/collector.py
          python -m py_compile src/config.py
          python -m py_compile src/dashboard.py
          python -m py_compile src/database.py
          python -m py_compile src/summarizer.py
          echo "✅ All files passed syntax check"

      - name: Check imports resolve correctly
        run: |
          cd $GITHUB_WORKSPACE
          python -c "from src.database import Database; print('✅ database OK')"
          python -c "from src.config import load_config; print('✅ config OK')"
          python -c "from src.alerts import AlertManager; print('✅ alerts OK')"
          python -c "from src.summarizer import Summarizer; print('✅ summarizer OK')"
